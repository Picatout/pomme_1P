

FHSI=16000000 ; 16Mhz 

RAM_BASE=0
RAM_SIZE=0x800
RAM_END=RAM_BASE+RAM_SIZE-1
EEPROM_BASE=0x1000 
EEPROM_SIZE=0x400
EEPROM_END=EEPROM_BASE+EEPROM_SIZE-1
OPTION_BASE=0x4800
OPTION_END=0x48FF 
BOOT_ROM=0x6000
BOOT_END=0x67FF 
FLASH_BASE=0x8000
FLASH_SIZE=0x8000
FLASH_END=FLASH_BASE+FLASH_SIZE-1
VECTOR_TABLE=0x8000
VECTOR_SIZE=0x80
VECTOR_END=VECTOR_TABLE+VECTOR_SIZE-1
CODE_START=0x8080

;;;;;;;;;;;
; bits
;;;;;;;;;;;;
 BIT0 = 0
 BIT1 = 1
 BIT2 = 2
 BIT3 = 3
 BIT4 = 4
 BIT5 = 5
 BIT6 = 6
 BIT7 = 7
 	
;;;;;;;;;;;;
; bits masks
;;;;;;;;;;;;
 B0_MASK = (1<<0)
 B1_MASK = (1<<1)
 B2_MASK = (1<<2)
 B3_MASK = (1<<3)
 B4_MASK = (1<<4)
 B5_MASK = (1<<5)
 B6_MASK = (1<<6)
 B7_MASK = (1<<7)

GPIO_BASE=0x5000
GPIO_ODR=0
GPIO_IDR=1
GPIO_DDR=2 
GPIO_CR1=3
GPIO_CR2=4

; gpio port A 
PORT_A=0x5000
PA_ODR=PORT_A
PA_IDR=0x5001
PA_DDR=0x5002 
PA_CR1=0x5003
PA_CR2=0x5004

; gpio port B 
PORT_B=(PORT_A+5)
PB_ODR=(PORT_B)
PB_IDR=(PB_ODR+1)
PB_DDR=(PB_IDR+1)
PB_CR1=(PB_DDR+1)
PB_CR2=(PB_CR1+1)

;gpio port C 
PORT_C=(PORT_B+5)
PC_ODR=(PORT_C)
PC_IDR=(PC_ODR+1)
PC_DDR=(PC_IDR+1)
PC_CR1=(PC_DDR+1)
PC_CR2=(PC_CR1+1)

; gpio port D 
PORT_D=(PORT_C+5)
PD_ODR=(PORT_D)
PD_IDR=(PD_ODR+1)
PD_DDR=(PD_IDR+1)
PD_CR1=(PD_DDR+1)
PD_CR2=(PD_CR1+1)

; gpio port E 
PORT_E=(PORT_D+5)
PE_ODR=(PORT_E)
PE_IDR=(PE_ODR+1)
PE_DDR=(PE_IDR+1)
PE_CR1=(PE_DDR+1)
PE_CR2=(PE_CR1+1)

; gpio port F 
PORT_F=(PORT_E+5)
PF_ODR=(PORT_F)
PF_IDR=(PF_ODR+1)
PF_DDR=(PF_IDR+1)
PF_CR1=(PF_DDR+1)
PF_CR2=(PF_CR1+1)

; input modes CR1
 INPUT_FLOAT = (0) ; no pullup resistor
 INPUT_PULLUP = (1)
; output mode CR1
 OUTPUT_OD = (0) ; open drain
 OUTPUT_PP = (1) ; push pull
; input modes CR2
 INPUT_DI = (0)
 INPUT_EI = (1)
; output speed CR2
 OUTPUT_SLOW = (0)
 OUTPUT_FAST = (1)

; flash memory registers 
FLASH_CR1=0x5050
FLASH_CR2=0x5051
FLASH_PUKR=0x5052
FLASH_DUKR=0x5053
FLASH_IAPSR=0x5054

; DMA config registers 
DMA_GCSR=0x5070 
DMA_GIR1=0x5071
DMA_C0CR=0X5075
DMA_C0SPR=0X5076
DMA_C0NDTR=0X5077
DMA_C0PARH=0X5078
DMA_C0PARL=0X5079
DMA_C0M0ARH=0X507B
DMA_C0M0ARL=0X507C
DMA_C1CR=0X507F
DMA_C1SPR=0X5080
DMA_C1NDTR=0X5081
DMA_C1PARH=0X5082
DMA_C1PARL=0X5083
DMA_C1M0ARH=0X5085
DMA_C1M0ARL=0X5086
DMA_C2CR=0X5089
DMA_C2SPR=0X508A
DMA_C2NDTR=0X508B
DMA_C2PARH=0X508C
DMA_C2PARL=0X508D
DMA_C2M0ARH=0X508F
DMA_C2M0ARL=0X5090
DMA_C3CR=0X5093
DMA_C3SPR=0X5094
DMA_C3NDTR=0X5095
DMA_C3PARH=0X5096
DMA_C3PARL=0X5097
DMA_C3M0ARH=0X5099
DMA_C3M0ARL=0X509A

; remapping registers 
SYSCFG_RMPCR1=0X509E
SYSCFG_RMPC2=0X509F

; ITC - EXTI 
EXTI_CR1=0X50A0
EXTI_CR2=0X50A1
EXTI_CR3=0X50A2
EXTI_SR1=0X50A3
EXTI_SR2=0X50A4
EXTI_CONF1=0X50A5

; WAIT FOR INTERRUPT
WFE_CR1=0X50A6
WFE_CR2=0X50A7
WFE_CR3=0X50A8

; RESET CONTROL 
RST_CR=0X50B0
RST_SR=0X50B1

; PWR CONTROL
PWR_CSR1=0X50B2
PWR_CCR2=0X50B3

; CLOCK CONTROL

; system clock divisor 
CLK_CKDIVR=0X50C0   ; bits 2:0 divisor 2^n
; clock rtc register
CLK_CRTCR=0X50C1 
CLK_CRTCR_RTCSWBSY=0
CLK_CRTCR_RTCSWBSY_RTCSEL=1 ; field 4:1 clock source {HSI,LSI,HSE,LSE}
CLK_CRTCR_RTCDIV=5 ; field 7:5 clock divisor 2^n 

; Internal clock register
CLK_ICKR=0X50C2

; Peripheral clock gating register 1
CLK_PCKENR1=0X50C3
CLK_PCKENR1_TIM2=0
CLK_PCKENR1_TIM3=1 
CLK_PCKENR1_TIM4=2
CLK_PCKENR1_I2C1=3 
CLK_PCKENR1_SPI=4
CLK_PCKENR1_USART1=5
CLK_PCKENR1_BEEP=6 
CLK_PCKENR1_DAC=7 

; Peripheral clock gating register 2
CLK_PCKENR2=0X50C4
CLK_PCKENR2_ADC1=0
CLK_PCKENR2_TIM1=1
CLK_PCKENR2_RTC=2
CLK_PCKENR2_LCD=3
CLK_PCKENR2_DMA1=4
CLK_PCKENR2_COMP=5
CLK_PCKENR2_ROM=7

CLK_CCOR=0X50C5
CLK_ECKR=0X50C6
CLK_SCSR=0X50C7
CLK_SWR=0X50C8
CLK_SWCR=0X50C9
CLK_CSSR=0X50CA
CLK_CBEEPR=0X50CB
CLK_HSICALR=0X50CC
CLK_HSITRIMR=0X50CD
CLK_HSIUNLCKR=0X50CE
CLK_REGCSR=0X50CF 

 CLK_SWCR_SWIF = (3)
 CLK_SWCR_SWIEN = (2)
 CLK_SWCR_SWEN = (1)
 CLK_SWCR_SWBSY = (0)

; WINDOW WATCH DOG 
WWDG_CR=0X50D3
WWDG_WR=0X50D4

; INDEPENDANT WATCH DOG 
IWDG_KR=0X50E0
IWDG_PR=0X50E1
IWDG_RLR=0X50E2

; BEEP 
BEEP_CSR1=0X50F0 
BEEP_SCR2=0X50F3

; REAL TIME CLOCK 
RTC_TR1=0X5140 ;Time register 
RTC_TR2=0X5141 ;Time register 
RTC_TR3=0X5142 ;Time register
RTC_DR1=0X5144 ;Date register 
RTC_DR2=0X5145 ;Date register 
RTC_DR3=0X5146 ;Date register
RTC_CR1=0X5148 ;Control register
RTC_CR2=0X5149 ;Control register
RTC_CR3=0X514A ;Control register
RTC_ISR1=0X514C ;Initialization and status register
RTC_ISR2=0X514D ;Initialization and Status register
RTC_SPRERH=0X5150 ;Synchronous prescaler register high
RTC_SPRERL=0X5151 ;Synchronous prescaler register low0
RTC_APRER=0X5152 ;Asynchronous prescaler register
RTC_WUTRH=0X5154 ;Wakeup timer register high
RTC_WUTRL=0X5155 ;Wakeup timer register low
RTC_WPR=0X5159 ;Write protection register
RTC_ALRMAR1=0X515C ;Alarm A register
RTC_ALRMAR2=0X515D ;Alarm A register
RTC_ALRMAR3=0X515E ;Alarm A register
RTC_ALRMAR4=0X515F ;Alarm A register

; SPI 
SPI_CR1=0x5200 ;SPI1 control register 
SPI_CR2=0x5201 ;SPI1 control register 
SPI_ICR=0x5202 ;SPI1 interrupt control register
SPI_SR=0x5203 ;SPI1 status register
SPI_DR=0x5204 ;SPI1 data register
SPI_CRCPR=0x5205 ;SPI1 CRC polynomial register
SPI_RXCRCR=0x5206 ;SPI1 Rx CRC register
SPI_TXCRCR=0x5207 ;SPI1 Tx CRC register

; SPI_CR1 bit fields 
  SPI_CR1_CPHA=0
  SPI_CR1_CPOL=1
  SPI_CR1_MSTR=2
  SPI_CR1_BR=3
  SPI_CR1_SPE=6
  SPI_CR1_LSBFIRST=7
  
; SPI_CR2 bit fields 
  SPI_CR2_SSI=0
  SPI_CR2_SSM=1
  SPI_CR2_RXONLY=2
  SPI_CR2_CRCNEXT=4
  SPI_CR2_CRCEN=5
  SPI_CR2_BDOE=6
  SPI_CR2_BDM=7  

; SPI_SR bit fields 
  SPI_SR_RXNE=0
  SPI_SR_TXE=1
  SPI_SR_WKUP=3
  SPI_SR_CRCERR=4
  SPI_SR_MODF=5
  SPI_SR_OVR=6
  SPI_SR_BSY=7


; I2C 
;I2C1 control register 1
I2C1_CR1=0x5210 
I2C1_CR1_PE=0 ; peripheral enable 
I2C1_CR1_SMBUS=1 ; SMBUS mode 
I2C1_CR1_SMBTYPE=3 ; SMBUS type 
I2C1_CR1_ENARP=4 ; ARP enable
I2C1_CR1_ENPEC=5 ; PEC enable
I2C1_CR1_ENGC=6 ; general call enable
I2C1_CR1_NOSTRETCH=7 ; clock stretching disable 
; I2C1 control register 2
I2C1_CR2=0x5211 
I2C1_CR2_START=0 ; start generation
I2C1_CR2_STOP=1 ; stop generation
I2C1_CR2_ACK=2 ; acknowledge enable
I2C1_CR2_POS=3 ; Acknowledge position (for data reception).
I2C1_CR2_PEC=4 ; Packet error checking.
I2C1_CR2_ALERT=5 ; SMBus alert
I2C1_CR2_SWRST=7 ; Software reset
; frequency register 
I2C1_FREQR=0x5212 ; bits 5:0 peripheral clock frequency
; Own address register LSB
I2C1_OARL=0x5213 
I2C1_OAR1L_ADD0=0 ; interface address bit 0 for 10 bits addr.
I2C1_OAR1L_ADD1=1 ; interface address bits 7:1  
;Own address register MSB
I2C1_OARH=0x5214
I2C1_OARH_ADD9_8=1 ; bits 2:1 9:8 of address 
I2C1_OARH_ADDCONF=6 ; Address mode configuration
I2C1_OARH_ADDMODE=7 ; Addressing mode (Slave mode) 7|10 ADDR select
I2C1_DR=0x5216 ; data register 
; I2C1 status register 1
I2C1_SR1=0x5217
I2C1_SR1_SB=0 ; start bit master mode 
I2C1_SR1_ADDR=1 ; address sent 
I2C1_SR1_BTF=2 ; byte transfert finished
I2C1_SR1_ADD10=3 ; 10 bits header sent 
I2C1_SR1_STOPF=4 ; stop detection 
I2C1_SR1_RXNE=6 ;  data register not empty 
I2C1_SR1_TXE=7  ;  data register empty 
; I2C1 status register 2
I2C1_SR2=0x5218
I2C1_SR2_BERR=0
I2C1_SR2_ARLO=1
I2C1_SR2_AF=2
I2C1_SR2_OVR=3
I2C1_SR2_PECERR=4
I2C1_SR2_WUFH=5
I2C1_SR2_TIMEOUT=6
I2C1_SR2_SMBALERT=7
; I2C1 status register 3
I2C1_SR3=0x5219
I2C1_SR3_MSL=0
I2C1_SR3_BUSY=1
I2C1_SR3_TRA=2
I2C1_SR3_GENCAL=4
I2C1_SR3_SMBDEFAULT=5
I2C1_SR3_SMBHOST=6
I2C1_SR3_DUALF=7
; I2C1 interrupt control register
I2C1_ITR=0x521A
I2C1_ITR_ITERREN=0
I2C1_ITR_ITEVTEN=1
I2C1_ITR_ITBUFEN=2
I2C1_ITR_DMAEN=3
I2C1_ITR_LAST=4
; I2C1 clock control register low
I2C1_CCRL=0x521B
; I2C1 clock control register high
I2C1_CCRH=0x521C
I2C1_CCRH_CCR=0 ; bits 3:0  SCLH 
I2C1_CCRH_DUTY=6 ; fast mode duty cycle 
I2C1_CCRH_FS=7 ; fast/slow mode selection 
; I2C1 TRISE register
I2C1_TRISER=0x521D ; bits 5:0 Maximum rise time in Fast/Standard mode
; I2C1 packet error checking register
I2C1_PECR=0x521E


; Precalculated values, all in KHz
 I2C_CCRH_16MHZ_FAST_400 = 0x80
 I2C_CCRL_16MHZ_FAST_400 = 0x0D
;
; Fast I2C mode max rise time = 300ns
; I2C_FREQR = 16 = (MHz) => tMASTER = 1/16 = 62.5 ns
; TRISER = = (300/62.5) + 1 = floor(4.8) + 1 = 5.

 I2C_TRISER_16MHZ_FAST_400 = 0x05

 I2C_CCRH_16MHZ_FAST_320 = 0xC0
 I2C_CCRL_16MHZ_FAST_320 = 0x02
 I2C_TRISER_16MHZ_FAST_320 = 0x05

 I2C_CCRH_16MHZ_FAST_200 = 0x80
 I2C_CCRL_16MHZ_FAST_200 = 0x1A
 I2C_TRISER_16MHZ_FAST_200 = 0x05

 I2C_CCRH_16MHZ_STD_100 = 0x00
 I2C_CCRL_16MHZ_STD_100 = 0x50

 I2C_STD = 0 
 I2C_FAST = 1 

; Standard I2C mode max rise time = 1000ns
; I2C_FREQR = 16 = (MHz) => tMASTER = 1/16 = 62.5 ns
; TRISER = = (1000/62.5) + 1 = floor(16) + 1 = 17.

 I2C_TRISER_16MHZ_STD_100 = 0x11

 I2C_CCRH_16MHZ_STD_50 = 0x00
 I2C_CCRL_16MHZ_STD_50 = 0xA0
 I2C_TRISER_16MHZ_STD_50 = 0x11

 I2C_CCRH_16MHZ_STD_20 = 0x01
 I2C_CCRL_16MHZ_STD_20 = 0x90
 I2C_TRISER_16MHZ_STD_20 = 0x11;

 I2C_READ = 1
 I2C_WRITE = 0



; USART1
USART1_SR=0x5230
USART1_DR=0x5231
USART1_BRR1=0x5232
USART1_BRR2=0x5233
USART1_CR1=0x5234
USART1_CR2=0x5235
USART1_CR3=0x5236
USART1_CR4=0x5237
USART1_CR5=0x5238
USART1_GTR=0x5239
USART1_PSCR=0x523A

UART1_PORT=PORT_C 
UART1_TX_PIN=3
UART1_RX_PIN=2

; UART Status Register bits
 UART_SR_TXE = (7)
 UART_SR_TC = (6)
 UART_SR_RXNE = (5)
 UART_SR_IDLE = (4)
 UART_SR_OR = (3)
 UART_SR_NF = (2)
 UART_SR_FE = (1)
 UART_SR_PE = (0)

; Uart Control Register 1 bits
 UART_CR1_R8 = (7)
 UART_CR1_T8 = (6)
 UART_CR1_UARTD = (5)
 UART_CR1_M = (4)
 UART_CR1_WAKE = (3)
 UART_CR1_PCEN = (2)
 UART_CR1_PS = (1)
 UART_CR1_PIEN = (0)
; UART control register 2 bits 
 UART_CR2_TIEN = (7)
 UART_CR2_TCIEN = (6)
 UART_CR2_RIEN = (5)
 UART_CR2_ILIEN = (4)
 UART_CR2_TEN = (3)
 UART_CR2_REN = (2)
 UART_CR2_RWU = (1)
 UART_CR2_SBK = (0)

; TIMER 2 
TIM2_CR1=0x5250
TIM2_CR2=0x5251
TIM2_SMCR=0x5252
TIM2_ETR=0x5253
TIM2_DER=0x5254
TIM2_IER=0x5255
TIM2_SR1=0x5256
TIM2_SR2=0x5257
TIM2_EGR=0x5258
TIM2_CCMR1=0x5259
TIM2_CCMR2=0x525A
TIM2_CCER1=0x525B
TIM2_CNTRH=0x525C
TIM2_CNTRL=0x525D
TIM2_PSCR=0x525E
TIM2_ARRH=0x525F
TIM2_ARRL=0x5260
TIM2_CCR1H=0x5261
TIM2_CCR1L=0x5262
TIM2_CCR2H=0x5263
TIM2_CCR2L=0x5264
TIM2_BKR=0x5265
TIM2_OISR=0x5266

; TIMER2 control register 1
TIM2_CR1_CEN=0 ; counter enable 
TIM2_CR1_UDIS=1 ; update disable 
TIM2_CR1_URS=2  ; update request source 
TIM2_CR1_OPM=3  ; one pulse mode 
TIM2_CR1_DIR=4  ; direction up/down
TIM2_CR1_CMS=5 ; 6:5 center-aligned mode
TIM2_CR1_ARPE=7 ; auto-reload preload enable 

; TIM3 capture compare mode regiser 1
; output compare 
TIM2_CCMR1_CCS1=0 ;1:0 capture/compare 1 selection 
TIM2_CCMR1_OC1FE=2 ; output compare fast enable 
TIM2_CCMR1_OC1PE=3 ; output compare 1 preload enable
TIM2_CCMR1_OC1M=4 ; 6:4  output compare 1 mode 
; input capture 
TIM2_CCMR1_CC1S=0 ; capture/compare 1 selection 
TIM2_CCMR1_IC1PSC=2 ; 3:2 input capture prescaler 
TIM2_CCMR1_IC1F=4 ;7:4 input capture 1 filter 

; TIM3 capture compare mode regiser 2
; output compare 
TIM2_CCMR2_CCS2=0 ;1:0 capture/compare 2 selection 
TIM2_CCMR2_OC2FE=2 ; output compare fast enable 
TIM2_CCMR2_OC2PE=3 ; output compare 2 preload enable
TIM2_CCMR2_OC2M=4 ; 6:4  output compare 2 mode 
; input capture 
TIM2_CCMR2_CC2S=0 ; capture/compare 2 selection 
TIM2_CCMR2_IC2PSC=2 ; 3:2 input capture prescaler 
TIM2_CCMR2_IC2F=4 ;7:4 input capture 2 filter 

; TIMER 2 capture compare channel enable 
TIM2_CCER1_CC1E=0 ; capture/compare 1 output enable 
TIM2_CCER1_CC1P=1 ; capture/comapre 1 output polarity
TIM2_CCER1_CC2E=4 ; capture/compare 2 output enable
TIM2_CCER1_CC2P=5 ; capture/comapre 2 output polarity

; TIMER 3
TIM3_CR1=0x5280
TIM3_CR2=0x5281
TIM3_SMCR=0x5282
TIM3_ETR=0x5283
TIM3_DER=0x5284
TIM3_IER=0x5285
TIM3_SR1=0x5286
TIM3_SR2=0x5287
TIM3_EGR=0x5288
TIM3_CCMR1=0x5289
TIM3_CCMR2=0x528A
TIM3_CCER1=0x528B
TIM3_CNTRH=0x528C
TIM3_CNTRL=0x528D
TIM3_PSCR=0x528E
TIM3_ARRH=0x528F
TIM3_ARRL=0x5290
TIM3_CCR1H=0x5291
TIM3_CCR1L=0x5292
TIM3_CCR2H=0x5293
TIM3_CCR2L=0x5294
TIM3_BKR=0x5295
TIM3_OISR=0x5296

; TIM3 bits fields 
TIM3_CR1_CEN=0 ; counter enable 
TIM3_CR1_UDIS=1 ; update disable 
TIM3_CR1_URS=2  ; update request source 
TIM3_CR1_OPM=3  ; one pulse mode 
TIM3_CR1_DIR=4  ; direction up/down
TIM3_CR1_CMS=5 ; 6:5 center-aligned mode
TIM3_CR1_ARPE=7 ; auto-reload preload enable 

; TIM3 capture compare mode regiser 1
; output compare 
TIM3_CCMR1_CCS1=0 ;1:0 capture/compare 1 selection 
TIM3_CCMR1_OC1FE=2 ; output compare fast enable 
TIM3_CCMR1_OC1PE=3 ; output compare 1 preload enable
TIM3_CCMR1_OC1M=4 ; 6:4  output compare 1 mode 
; input capture 
TIM3_CCMR1_CC1S=0 ; capture/compare 1 selection 
TIM3_CCMR1_IC1PSC=2 ; 3:2 input capture prescaler 
TIM3_CCMR1_IC1F=4 ;7:4 input capture 1 filter 

; TIM3 capture compare mode regiser 2
; output compare 
TIM3_CCMR2_CCS2=0 ;1:0 capture/compare 2 selection 
TIM3_CCMR2_OC2FE=2 ; output compare fast enable 
TIM3_CCMR2_OC2PE=3 ; output compare 2 preload enable
TIM3_CCMR2_OC2M=4 ; 6:4  output compare 2 mode 
; input capture 
TIM3_CCMR2_CC2S=0 ; capture/compare 2 selection 
TIM3_CCMR2_IC2PSC=2 ; 3:2 input capture prescaler 
TIM3_CCMR2_IC2F=4 ;7:4 input capture 2 filter 

; TIMER 3 capture compare channel enable 
TIM3_CCER1_CC1E=0 ; capture/compare 1 output enable 
TIM3_CCER1_CC1P=1 ; capture/comapre 1 output polarity
TIM3_CCER1_CC2E=4 ; capture/compare 2 output enable
TIM3_CCER1_CC2P=5 ; capture/comapre 2 output polarity

; TIMER 1
TIM1_CR1=0x52B0
TIM1_CR2=0x52B1
TIM1_SMCR=0x52B2
TIM1_ETR=0x52B3
TIM1_DER=0x52B4
TIM1_IER=0x52B5
TIM1_SR1=0x52B6
TIM1_SR2=0x52B7
TIM1_EGR=0x52B8
TIM1_CCMR1=0x52B9
TIM1_CCMR2=0x52BA
TIM1_CCMR3=0x52BB
TIM1_CCMR4=0x52BC
TIM1_CCER1=0x52BD
TIM1_CCER2=0x52BE
TIM1_CNTRH=0x52BF
TIM1_CNTRL=0x52C0
TIM1_PSCRH=0x52C1
TIM1_PSRCL=0x52C2
TIM1_ARRH=0x52C3
TIM1_ARRL=0x52C4
TIM1_RCR=0X52C5
TIM1_CCR1H=0x52C6
TIM1_CCR1L=0x52C7
TIM1_CCR2H=0x52C8
TIM1_CCR2L=0x52C9
TIM1_CCR3H=0x52CA
TIM1_CCR3L=0x52CB
TIM1_CCR4H=0x52CC
TIM1_CCR4L=0x52CD
TIM1_BKR=0x52CE
TIM1_DTR=0x52CF
TIM1_OISR=0x52D0
TIM1_DCR1=0X52D1
TIM1_DCR2=0X52D2
TIM1_DMA1R=0X52D3

; TIMER 4
;control register 1
TIM4_CR1=0x52E0
TIM4_CR1_CEN=0 ;counter enable
TIM4_CR1_UDIS=1 ; update disable 
TIM4_CR1_URS=2 ; update request source 
TIM4_CR1_OPM=3 ; one pulse mode 
TIM4_CR1_arpe=7 ; auto-reload preload enable 
; control register 2 
TIM4_CR2=0x52E1
TIM4_SMCR=0x52E2
TIM4_DER=0x52E3
; interrupt enable register 
TIM4_IER=0x52E4
TIM4_IER_UIE=0 ; update interrupt enable 
TIM4_IER_TIE=6 ; trigger interrupt enable 

TIM4_SR=0x52E5
TIM4_EGR=0x52E6
TIM4_CNTR=0x52E7
TIM4_PSCR=0x52E8
TIM4_ARR=0x52E9

; infrared control IRTIM
IR_CR=0x52FF

; ADC1 
ADC1_CR1=0x5340
ADC1_CR2=0x5341
ADC1_CR3=0x5342
ADC1_SR=0x5343
ADC1_DRH=0x5344
ADC1_DRL=0x5345
ADC1_HTRH=0x5346
ADC1_HTRL=0x5347
ADC1_LTRH=0x5348
ADC1_LTRL=0x5349
ADC1_SQR1=0x534A
ADC1_SQR2=0x534B
ADC1_SQR3=0x534C
ADC1_SQR4=0x534D
ADC1_TRIGR1=0x534E
ADC1_TRIGR2=0x534F
ADC1_TRIGR3=0x5350
ADC1_TRIGR4=0x5351



; DAC 
DAC_CR1=0x5380 
DAC_CR2=0x5381
DAC_SWTRIGR=0x5384
DAC_SR=0x5385
DAC_RDHRH=0x5388
DAC_RDHRL=0x5389
DAC_LDHRH=0x538C
DAC_LDHRL=0x538D
DAC_DHR8=0x5390
DAC_DORH=0x53AC
DAC_DORL=0x53AD

; LCD 
LCD_CR1=0x5400
LCD_CR2=0x5401
LCD_CR3=0x5402
LCD_FRQ=0x5403
LCD_PM0=0x5404
LCD_PM1=0x5405
LCD_PM2=0x5406
LCD_PM3=0x5407
LCD_RAM0=0x540C
LCD_RAM1=0x540D
LCD_RAM2=0x540E
LCD_RAM3=0x540F
LCD_RAM4=0x5410
LCD_RAM5=0x5411
LCD_RAM6=0x5412
LCD_RAM7=0x5413
LCD_RAM8=0x5414
LCD_RAM9=0x5415
LCD_RAM10=0x5416
LCD_RAM11=0x5417
LCD_RAM12=0x5418
LCD_RAM13=0x5419

; RI 
RI_ICR1=0x5431
RI_ICR2=0x5432
RI_IOIR1=0x5433
RI_IOIR2=0x5434
RI_IOIR3=0x5435
RI_IOCMR1=0x5436
RI_IOCMR2=0x5437
RI_IOCMR3=0x5438
RI_IOSR1=0x5439
RI_IOSR2=0x543A
RI_IOSR3=0x543B
RI_IOGCR=0x543C
RI_ASCR1=0x543D
RI_ASCR2=0x543E
RI_RCR=0x543F

; COMP  
COMP_CSR1=0x5440
COMP_CSR2=0x5441
COMP_CSR3=0x5442
COMP_CSR4=0x5443
COMP_CSR5=0x5444

; CPU config 
CFG_GCR=0x7F60 

; ITC-SPR  interrupt priority
ITC_SPR1=0x7F70
ITC_SPR2=0x7F71
ITC_SPR3=0x7F72
ITC_SPR4=0x7F73
ITC_SPR5=0x7F74
ITC_SPR6=0x7F75
ITC_SPR7=0x7F76
ITC_SPR8=0x7F77

; SWIM 
SWIM_CSR=0x7F80 

; interrupt numbers 
INT_FLASH=0
INT_DMA1_01=2
INT_DMA1_23=3
INT_RTC=4
INT_EXTI_EF_PVD=5
INT_EXTI_BG=6
INT_EXTI_DH=7
INT_EXTI0=8
INT_EXTI1=9
INT_EXTI2=10
INT_EXTI3=11
INT_EXTI4=12
INT_EXTI5=13
INT_EXTI6=14
INT_EXTI7=15
INT_LCD=16
INT_CLK_TIM1_BRK_DAC=17
INT_COMP1_COMP2_ADC1=18
INT_TIM2_OVF=19
INT_TIM2_CC=20
INT_TIM3_OVF=21
INT_TIM3_CC=22
INT_TIM1_OVF=23
INT_TIM1_CC=24
INT_TIM4=25
INT_SPI1=26
INT_USART1_TXE=27
INT_USART1_RX=28
INT_I2C=29

; interrupt vectors address 
VECTOR_RST=0x8000
VECTOR_TRAP=0X8004 
VECTOR_FLASH=0X800C
VECTOR_DMA1_01=0X8010
VECTOR_DMA1_23=0X8014
VECTOR_RTC=0X8018
VECTOR_EXTI_EF_PVD=0X801C
VECTOR_EXTI_BG=0X8020
VECTOR_EXIT_DH=0X8024
VECTOR_EXTI0=0X8028
VECTOR_EXTI1=0X802C
VECTOR_EXTI2=0X8030
VECTOR_EXTI3=0X8034
VECTOR_EXTI4=0X8038
VECTOR_EXTI5=0X803C
VECTOR_EXTI6=0X8040
VECTOR_EXTI7=0X8044
VECTOR_LCD=0X8048
VECTOR_CLK_TIM1_BRK_DAC=0X804C
VECTOR_COMP1_COMP2_ADC1=0X8050
VECTOR_TIM2_OVF=0X8054
VECTOR_TIM2_CC=0X8058
VECTOR_TIM3_OVF=0X805C 
VECTOR_TIM3_CC=0X8060
VECTOR_TIM1_OVF=0X8064
VECTOR_TIM1_CC=0X8068
VECTOR_TIM4=0X806C
VECTOR_SPI1=0X8070
VECTOR_USART1_TXE=0X8074
VECTOR_USART1_RX=0X8078
VECTOR_I2C=0X807C



